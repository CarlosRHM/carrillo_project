\section{Modelo}
\subsection{Descripción del Entorno Biológico.}

Considérese un organismo con acceso a dos recursos para su supervivencia. Sean $S_1$ y $S_2$ las concentraciones de estos dos recursos contenidos en un chemostat. Entonces el vector:
\begin{equation}
	I=\binom{S_{1}}{S_{2}},
\end{equation}

constituye la condición ambiental para el consumidor.\citep{Diekmann2001, diekman2003}.

Ahora bien, estos organismos pueden especializarse de mayor o menor medida en el consumo de cualquiera de los 2 recursos a su disposición. Describimos esto en un rasgo cuantizable $x$ que varía continuamente entre $[0,1]$. Si $x$ equivale a 0, sólo el recurso $S_2$ es consumido, caso contrario cuando equivale 1, sólo se consume el recurso $S_1$. Extendiendo a escala poblacional, el impacto causado por el rasgo $x$ se toma implícitamente dentro de los coeficientes $\eta(x)$ y $\xi(x)$, definidos de tal manera que la proporción de ingesta \textit{per cápita} de un solo organismo con rasgo $x$ equivale, respectivamente a: $\eta(x)$ $S_1$ y $\xi(x)$ $S_2$.\citep{dieckman2005}

En el caso de una población monomórfica, la dinámica ecológica está gobernada por el siguiente sistema de ecuaciones diferenciales:
\begin{equation}\label{eqmono}
	\begin{split}
		\frac{d S_1}{dx} & =S_{01}-S_1-\eta(x)S_1X \\  \frac{d S_2}{dx}&=S_{02}-S_2-\xi(x)S_2X\\ \frac{d X}{dx}&=-X+\eta(x)S_1X+\xi(x)S_2X
	\end{split}
\end{equation}

Donde X representa la densidad de la población consumidora y $S_{01}$ es la concentración del recurso i ($i\in\{1,2\}$) en el medio de entrada, para este modelo, la tasa de crecimiento poblacional de los consumidores con el rasgo $x$ bajo condiciones ambientales estables $I$ ($\frac{d X}{dx}=0$ en la tercera expresión de \eqref{eqmono}), está dada por:
\begin{equation}\label{r}
	\begin{split}
		0      & =r(x,I)X                  \\
		r(x,I) & =-1+\eta(x)S_1+\xi(x)S_2.
	\end{split}
\end{equation}

Por lo tanto la primera condición para estados estables es:
\begin{equation*}
	r(x,I)=0
\end{equation*}

Para las 2 primeras expresiones de \eqref{eqmono} obtenemos lo siguiente para las mismas condiciones de estabilidad:
\begin{equation*}
	\begin{split}
		0 & =S_{01}-S_1-\eta(x)S_1X \\  0&=S_{02}-S_2-\xi(x)S_2X
	\end{split}
\end{equation*}
Con la que, obteniendo $S_1$ y $S_2$ en términos de $X$ y sustituyendo en nuestra primera condición de estabilidad $r=0$ tenemos:

\begin{equation*}
	-1+\frac{\eta(x)S_{01}}{1+\eta(x)X}+\frac{\xi(x)S_{02}}{1+\xi(x)X}=0
\end{equation*}

Que es una función monótona decreciente de $X$ con límite -1 para $X\to\infty$, y que tiene solución positiva para X=0 solo si:
\begin{equation}\label{global}
	\eta(x)S_{01}X+\xi(x)S_{02}X>1,
\end{equation}
entonces \eqref{eqmono} tiene un único estado estable no trivial que es asintótico globalmente, dado que cumpla \eqref{global}.

\subsection{Sistemas de Ecuaciones de Selección-Mutación y Paso al Límite para Mutaciones.}

Si la reproducción no es completamente fiel (aparece alguna mutación), un consumidor con el rasgo $y$ puede generar descendencia con el rasgo $x$. Sea $K(x,y)$ la densidad de probabilidad correspondiente. Sea $n(t,.)$ la densidad de consumidores en el tiempo t. El sistema \citep{dieckman2005}:

\begin{equation}\label{core}
	\begin{split}
		\frac{d S_1}{dt}(t) & =S_{01}-S_1(t)-S_1(t)\int_{0}^{1}\eta(y)n(t,x)dx,                \\
		\frac{d S_1}{dt}(t) & =S_{02}-S_2(t)-S_2(t)\int_{0}^{1}\xi(x)n(t,x)dx                  \\
		\frac{d n}{dt}(t,x) & =-n(t,x)+\int_{0}^{1}K(x,y)[S_1(t)\eta(y)+S_2(t)\xi(x)]n(t,y)dy,
	\end{split}
\end{equation}

describe la interacción, a través de los recursos, de los diversos tipos de consumidores, así como el efecto de la mutación, le denominaremos sistema de ecuaciones de selección-mutación. Tomamos que la descendencia de un individuo con el rasgo $x$ tiene una distribución de rasgos descrita por la densidad $K(x,.)$.

Además, asumiendo que las mutaciones son muy pequeñas, de tal manera que la distribución de probabilidad $K(x,y)$ es muy pequeño para $x$ fuera de un vecindario de radio $\varepsilon$ con ''centro'' en $y$, $\varepsilon>0$ muy pequeño, entonces tomamos $K(x,y)\to K_{\varepsilon}(x,y)$ dependiente de este pequeño parámetro $\varepsilon$.\citep{dieckman2005}

Reescalamos el tiempo sustituyendo $\tau=\varepsilon$t (este escalamiento ajusta la escala temporal de modo que, al hacer $\varepsilon$ desaparecer, la escala de tiempo se adapte para observar el efecto de las mutaciones), reescribimos \eqref{core}:

\begin{equation}\label{nocon}
	\frac{\varepsilon}{n(\tau,x)}\frac{d n(\tau,x)}{d\tau}=-1+\int_{0}^{1}K(x,y)_{\varepsilon}[S_1(\tau)\eta(y)+S_2(\tau)\xi(x)]\frac{n(y,\tau)}{n(\tau,x)}dy.
\end{equation}

a la que a la vez podemos luego realizar la siguiente transformación

\begin{equation*}
	\varphi(\tau,x)=\varepsilon ln[n(\tau,x)],
\end{equation*}
entonces:
\begin{equation*}
	\frac{d\varphi(\tau,x) }{d\tau}=\int_{0}^{1}K_{\varepsilon}(x,y)[S_1(\tau)\eta(y)+S_2(\tau)\xi(x)]e^{\frac{\varphi(\tau,y)-\varphi(\tau,x)}{\varepsilon}}dy
\end{equation*}

Aprovechando lo mencionado anteriormente sobre $K_{\varepsilon}(x,y)$ realizamos el cambio de variable de integración $y=x+\varepsilon z$ y de la definición de derivada parcial:

\begin{equation*}
	\frac{\varphi(\tau,y)-\varphi(\tau,x)}{\varepsilon} \to \frac{d\varphi(\tau,x) }{dx}z
\end{equation*}

y asumimos que la probabilidad de aparición de un nuevo rasgo como resultado de una mutación depende únicamente de la distancia al rasgo original. Por lo tanto, reemplazamos el kernel $K_{\varepsilon}$ por un kernel de convolución $\widetilde{K}$:

\begin{equation*}
	K_{\varepsilon}(x,y)dy\longrightarrow \widetilde{K}(z)dz
\end{equation*}

Donde $\widetilde{K}$ es una función no negativa y par definida en $(-\infty,+\infty)$, cuya integral es igual a 1. Al tomar formalmente el límite cuando $\varepsilon\to 0$ en \eqref{nocon}, obtenemos:

\begin{equation}\label{hj}
	\frac{d\varphi(t,x) }{dx}=-r(x,I)+[S_1(t)\eta(y)+S_2(t)\xi(x)]\Ham(\frac{\partial \varphi(t,x) }{\partial x})
\end{equation}

la ecuación de Hamilton-Jacobi, dónde r se define en \eqref{r} y $\Ham$ se toma como:
\begin{equation*}
	\Ham(p)=\int_{-\infty}^{\infty}\widetilde{K}(z)e^{-pz}dz-1
\end{equation*}

y que cumple $\Ham(0)=0$ y que, para una función par $\widetilde{K}$, $\Ham'(0)>0$; por lo tanto, $\Ham$ es convexa. Llamamos a $\Ham$ el Hamiltoniano correspondiente a $\widetilde{K}$.

\input{03.03_metodo_numerico.tex}